<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>áƒ—áƒ”áƒáƒ áƒ˜áƒ áƒ“áƒáƒ˜áƒœáƒ˜áƒœáƒ’áƒ˜</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Georgian:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { background:#FAF7F2; font-family:'Noto Sans Georgian','DM Sans',sans-serif; color:#1A1410; }
#open-banner { display:none; position:fixed; top:0; left:0; right:0; z-index:9999; background:#1A1410; color:#fff; padding:14px 18px; text-align:center; box-shadow:0 2px 12px rgba(0,0,0,.4); }
#open-banner p { font-size:.85rem; color:#ccc; margin-bottom:8px; }
#open-banner a { display:inline-block; background:#C8952A; color:#fff; padding:10px 22px; border-radius:8px; font-size:.9rem; font-weight:600; text-decoration:none; }
#open-banner .tip { font-size:.72rem; color:#8B7355; margin-top:6px; }
header { background:#1A1410; padding:22px 24px 18px; text-align:center; position:sticky; top:0; z-index:50; }
header h1 { font-family:'Noto Sans Georgian','Playfair Display',serif; font-size:1.8rem; color:#E8B84B; letter-spacing:.04em; }
header p { color:#8B7355; font-size:.78rem; margin-top:3px; letter-spacing:.08em; text-transform:uppercase; }
.info-bar { background:#FFFDF9; border-bottom:1px solid #E2D9CC; padding:14px 24px; display:-webkit-flex; display:flex; -webkit-align-items:flex-end; align-items:flex-end; gap:18px; -webkit-flex-wrap:wrap; flex-wrap:wrap; }
.info-field { display:-webkit-flex; display:flex; -webkit-flex-direction:column; flex-direction:column; gap:4px; }
.info-field label { font-size:.7rem; text-transform:uppercase; letter-spacing:.07em; color:#8B7355; font-weight:500; }
.info-field input { padding:8px 10px; border:2px solid #E2D9CC; border-radius:6px; font-size:.93rem; font-family:'Noto Sans Georgian','DM Sans',sans-serif; background:#fff; color:#1A1410; -webkit-appearance:none; width:180px; }
.info-field input.narrow { width:68px; }
.info-field input:focus { outline:none; border-color:#C8952A; }
.min-note { font-size:.75rem; color:#8B7355; padding-bottom:8px; }
main { max-width:900px; margin:0 auto; padding:24px 16px 200px; }
.footer-bar { position:fixed; bottom:0; left:0; right:0; background:#1A1410; color:#fff; padding:12px 24px; display:-webkit-flex; display:flex; -webkit-align-items:center; align-items:center; -webkit-justify-content:space-between; justify-content:space-between; -webkit-flex-wrap:wrap; flex-wrap:wrap; gap:8px; z-index:100; box-shadow:0 -4px 20px rgba(0,0,0,.3); }
.totals-col { display:-webkit-flex; display:flex; -webkit-flex-direction:column; flex-direction:column; gap:2px; min-width:140px; }
.trow { display:-webkit-flex; display:flex; -webkit-justify-content:space-between; justify-content:space-between; gap:20px; font-size:.78rem; color:#aaa; }
.trow.sub { color:#ccc; }
.trow.svc { color:#aaa; border-top:1px solid #333; padding-top:3px; margin-top:2px; }
.trow.grand { color:#E8B84B; font-family:'Noto Sans Georgian','Playfair Display',serif; font-size:1.05rem; font-weight:600; border-top:1px solid #444; padding-top:4px; margin-top:3px; }
.trow span:last-child { text-align:right; }
.item-ct { font-size:.7rem; color:#8B7355; margin-top:2px; }
.val-block { text-align:center; -webkit-flex:1; flex:1; padding:0 6px; }
.val-msg { font-size:.8rem; padding:6px 12px; border-radius:6px; display:inline-block; color:#8B7355; }
.val-msg.ok { background:rgba(46,125,82,.2); color:#7EDDA5; border:1px solid rgba(46,125,82,.4); }
.val-msg.warn { background:rgba(192,57,43,.2); color:#F1948A; border:1px solid rgba(192,57,43,.4); }
.confirm-btn { background:#C8952A; color:#fff; border:none; padding:12px 20px; border-radius:8px; font-family:'Noto Sans Georgian','DM Sans',sans-serif; font-size:.88rem; font-weight:500; cursor:pointer; white-space:nowrap; -webkit-tap-highlight-color:transparent; }
.confirm-btn:disabled { background:#555; }
#overlay { display:none; position:fixed; top:0; left:0; right:0; bottom:0; z-index:200; background:rgba(0,0,0,.55); overflow-y:auto; -webkit-overflow-scrolling:touch; }
#overlay.show { display:block; }
#ov-panel { background:#fff; margin:12px; border-radius:12px; overflow:hidden; }
#ov-bar { background:#1A1410; padding:12px 16px; display:-webkit-flex; display:flex; -webkit-align-items:center; align-items:center; -webkit-justify-content:space-between; justify-content:space-between; gap:8px; -webkit-flex-wrap:wrap; flex-wrap:wrap; }
#ov-bar span { color:#aaa; font-size:.75rem; text-transform:uppercase; letter-spacing:.05em; }
.ov-btn { border:none; padding:9px 16px; border-radius:6px; font-family:'Noto Sans Georgian','DM Sans',sans-serif; font-size:.82rem; font-weight:500; cursor:pointer; -webkit-tap-highlight-color:transparent; white-space:nowrap; }
.ov-btn.send-btn { background:#C8952A; color:#fff; }
.ov-btn.send-btn:disabled { background:#777; }
.ov-btn.close-btn { background:#333; color:#ccc; }
#ov-body { padding:22px 18px 18px; font-size:12px; color:#1A1410; }
#ov-footer { padding:12px 16px 16px; display:flex; justify-content:center; }
#ov-footer .send-btn { width:100%; font-size:1rem; padding:14px; border-radius:8px; }
.rc-head { text-align:center; border-bottom:2px solid #C8952A; padding-bottom:12px; margin-bottom:14px; }
.rc-head h2 { font-family:'Noto Sans Georgian','Playfair Display',serif; font-size:20px; }
.rc-head p { color:#8B7355; font-size:8px; text-transform:uppercase; letter-spacing:.1em; margin-top:2px; }
.rc-meta { display:-webkit-flex; display:flex; -webkit-justify-content:space-between; justify-content:space-between; margin-bottom:14px; font-size:10px; color:#555; }
.rc-gn { font-family:'Noto Sans Georgian','Playfair Display',serif; font-size:13px; color:#1A1410; font-weight:700; margin-bottom:2px; }
.rc-rt { text-align:right; line-height:1.7; }
.rc-tbl { width:100%; border-collapse:collapse; margin-bottom:14px; }
.rc-tbl thead tr { background:#1A1410; }
.rc-tbl thead th { color:#E8B84B; padding:6px 7px; font-size:8px; text-transform:uppercase; letter-spacing:.06em; font-weight:500; text-align:left; }
.rc-tbl thead th.r { text-align:right; }
.rc-tbl tbody tr { border-bottom:1px solid #eee; }
.rc-tbl tbody td { padding:6px 7px; font-size:10.5px; }
.rc-cat td { background:#F5EFE6; color:#6B4C35; font-weight:600; font-size:8px; text-transform:uppercase; letter-spacing:.05em; padding:4px 7px; border-top:2px solid #E2D9CC; }
.rc-tbl .r { text-align:right; }
.rc-tots { text-align:right; margin-bottom:14px; }
.rc-ti { display:inline-table; border-collapse:collapse; min-width:200px; }
.rc-ti td { padding:4px 8px; font-size:10.5px; }
.rc-ti .lb { color:#555; }
.rc-ti .vl { text-align:right; }
.rc-ti .svc-r td { border-top:1px solid #ddd; color:#555; }
.rc-ti .gnd-r td { border-top:2px solid #C8952A; font-family:'Noto Sans Georgian','Playfair Display',serif; font-size:13px; font-weight:700; padding-top:6px; }
.rc-foot { border-top:1px solid #E2D9CC; padding-top:9px; text-align:center; font-size:8.5px; color:#8B7355; line-height:1.8; }
</style>
<style media="print">
* { -webkit-print-color-adjust:exact !important; print-color-adjust:exact !important; }
#open-banner, header, .info-bar, .footer-bar, main { display:none !important; }
#overlay { display:block !important; position:static !important; background:none !important; overflow:visible !important; }
#ov-panel { margin:0 !important; border-radius:0 !important; }
#ov-bar { display:none !important; }
</style>
</head>
<body>

<div id="open-banner">
  <p>This menu works best in Safari. Tap below to open it properly:</p>
  <a id="safari-link" href="#">Open in Safari</a>
  <div class="tip">After tapping, choose "Open in Safari" if prompted</div>
</div>

<header>
  <h1 id="r-name">áƒ—áƒ”áƒáƒ áƒ˜áƒ áƒ“áƒáƒ˜áƒœáƒ˜áƒœáƒ’áƒ˜</h1>
  <p>áƒáƒ˜áƒ áƒ©áƒ˜áƒ”áƒ— áƒ™áƒ”áƒ áƒ«áƒ”áƒ‘áƒ˜ áƒ›áƒ”áƒœáƒ˜áƒ£áƒ“áƒáƒœ</p>
</header>

<div class="info-bar">
  <div class="info-field">
    <label>áƒ¡áƒ¢áƒ£áƒ›áƒ áƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜</label>
    <input type="text" id="guest-name" placeholder="Enter your name" autocomplete="name" autocorrect="off" autocapitalize="words">
  </div>
  <div class="info-field">
    <label>áƒ¡áƒ¢áƒ£áƒ›áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ</label>
    <input type="number" id="guest-count" class="narrow" min="1" value="2" inputmode="numeric">
  </div>
  <span class="min-note" id="min-note">áƒ›áƒ˜áƒœáƒ˜áƒ›áƒ£áƒ›áƒ˜: 60 áƒšáƒáƒ áƒ˜ áƒ”áƒ áƒ— áƒ¡áƒ¢áƒ£áƒ›áƒáƒ áƒ–áƒ”</span>
</div>

<main id="menu-wrap"></main>

<div class="footer-bar">
  <div class="totals-col">
    <div class="trow sub"><span>áƒ¯áƒáƒ›áƒ˜</span><span id="f-sub">0</span></div>
    <div class="trow svc"><span>áƒ›áƒáƒ›áƒ¡áƒáƒ®áƒ£áƒ áƒ”áƒ‘áƒ 10%</span><span id="f-svc">0</span></div>
    <div class="trow grand"><span>áƒ›áƒ—áƒšáƒ˜áƒáƒœáƒáƒ“</span><span id="f-grand">0</span></div>
    <div class="item-ct" id="f-ct">áƒ™áƒ”áƒ áƒ«áƒ˜ áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒáƒ áƒ©áƒ”áƒ£áƒšáƒ˜</div>
  </div>
  <div class="val-block">
    <div class="val-msg" id="val-msg">Add items to begin</div>
  </div>
  <button class="confirm-btn" id="confirm-btn" disabled>áƒœáƒáƒ®áƒ”áƒ— áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ áƒ“áƒ áƒ’áƒáƒ“áƒáƒáƒ’áƒ–áƒáƒ•áƒœáƒ”áƒ—</button>
</div>

<div id="overlay">
  <div id="ov-panel">
    <div id="ov-bar">
      <span>áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ</span>
      <button class="ov-btn close-btn" id="ov-close">&#10005; áƒ“áƒáƒ®áƒ£áƒ áƒ•áƒ áƒ“áƒ áƒ¨áƒ”áƒªáƒ•áƒšáƒ</button>
    </div>
    <div id="ov-body"></div>
    <div id="ov-footer">
      <button class="ov-btn send-btn" id="ov-send">&#128228; áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ / PDF áƒ¨áƒ”áƒœáƒáƒ®áƒ•áƒ</button>
    </div>
  </div>
</div>

<script>
// =============================================================================
// MENU DATA â€” update via admin-upload.html
// =============================================================================
var MENU_DATA = {
  "restaurantName": "áƒ—áƒ”áƒáƒ áƒ˜áƒ áƒ“áƒáƒ˜áƒœáƒ˜áƒœáƒ’áƒ˜",
  "minimumPerGuest": 60,
  "categories": [
    {
      "name": "áƒ¡áƒáƒšáƒáƒ—áƒ˜",
      "items": [
        {
          "id": 1,
          "name": "áƒ‘áƒáƒ“áƒ áƒ˜áƒ¯áƒœáƒ˜áƒ¡ áƒ‘áƒ£áƒ áƒ—áƒ£áƒšáƒ”áƒ‘áƒ˜",
          "desc": "",
          "price": 25
        },
        {
          "id": 2,
          "name": "áƒ‘áƒáƒ“áƒ áƒ˜áƒ¯áƒœáƒ˜áƒ¡ áƒ¡áƒáƒšáƒáƒ—áƒ˜ áƒ›áƒáƒ¬áƒ•áƒœáƒ˜áƒ—",
          "desc": "",
          "price": 22
        },
        {
          "id": 3,
          "name": "áƒ‘áƒ”áƒ áƒ«áƒœáƒ£áƒšáƒ˜ áƒ¡áƒáƒšáƒáƒ—áƒ˜",
          "desc": "",
          "price": 18
        },
        {
          "id": 7,
          "name": "áƒ™áƒ˜áƒ¢áƒ áƒ˜-áƒáƒáƒ›áƒ˜áƒ“áƒ•áƒ áƒ˜áƒ¡ áƒ¡áƒáƒšáƒáƒ—áƒ˜",
          "desc": "",
          "price": 16
        },
        {
          "id": 8,
          "name": "áƒ™áƒ˜áƒ¢áƒ áƒ˜-áƒáƒáƒ›áƒ˜áƒ“áƒ•áƒ áƒ˜áƒ¡ áƒ¡áƒáƒšáƒáƒ—áƒ˜ áƒœáƒ˜áƒ’áƒ•áƒ–áƒ˜áƒ—",
          "desc": "",
          "price": 18
        },
        {
          "id": 21,
          "name": "áƒ¢áƒ§áƒšáƒáƒáƒ˜áƒ¡ áƒ¡áƒáƒšáƒáƒ—áƒ˜",
          "desc": "",
          "price": 18
        },
        {
          "id": 22,
          "name": "áƒ¤áƒ®áƒáƒšáƒ˜áƒ¡ áƒáƒ¡áƒáƒ áƒ¢áƒ˜",
          "desc": "",
          "price": 28
        },
        {
          "id": 32,
          "name": "áƒªáƒ”áƒ–áƒáƒ  áƒ¡áƒáƒšáƒáƒ—áƒ˜ áƒ™áƒ áƒ”áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ˜áƒ—",
          "desc": "",
          "price": 30
        },
        {
          "id": 33,
          "name": "áƒªáƒ”áƒ–áƒáƒ  áƒ¡áƒáƒšáƒáƒ—áƒ˜ áƒ¥áƒáƒ—áƒ›áƒ˜áƒ—",
          "desc": "",
          "price": 30
        }
      ]
    },
    {
      "name": "áƒªáƒ®áƒ”áƒšáƒ˜",
      "items": [
        {
          "id": 4,
          "name": "áƒ”áƒšáƒáƒ áƒ¯áƒ˜áƒ¡ áƒ‘áƒáƒšáƒ˜áƒ¨áƒ”áƒ‘áƒ˜ áƒ‘áƒáƒŸáƒ”áƒ¡ áƒ¡áƒáƒ£áƒ¡áƒ¨áƒ˜",
          "desc": "",
          "price": 28
        },
        {
          "id": 12,
          "name": "áƒáƒ¡áƒ¢áƒ áƒ˜ áƒ™áƒ”áƒªáƒ–áƒ”",
          "desc": "",
          "price": 38
        },
        {
          "id": 13,
          "name": "áƒáƒ¯áƒáƒ®áƒ£áƒ áƒ˜ áƒ™áƒ”áƒªáƒ–áƒ”",
          "desc": "",
          "price": 28
        },
        {
          "id": 18,
          "name": "áƒ áƒ˜áƒ‘áƒáƒ˜ áƒ¡áƒ¢áƒ”áƒ˜áƒ™áƒ˜",
          "desc": "",
          "price": 75
        },
        {
          "id": 19,
          "name": "áƒ¡áƒáƒ™áƒ áƒ™áƒ”áƒªáƒ–áƒ” áƒ¡áƒ£áƒšáƒ’áƒ£áƒœáƒ˜áƒ—",
          "desc": "",
          "price": 22
        },
        {
          "id": 23,
          "name": "áƒ¥áƒáƒ‘áƒáƒ‘áƒ˜",
          "desc": "",
          "price": 28
        },
        {
          "id": 24,
          "name": "áƒ¥áƒáƒ—áƒ›áƒ˜áƒ¡ áƒ‘áƒáƒšáƒáƒ¢áƒ˜áƒœáƒ˜",
          "desc": "",
          "price": 28
        },
        {
          "id": 25,
          "name": "áƒ¥áƒáƒ—áƒ›áƒ˜áƒ¡ áƒ›áƒ¬áƒ•áƒáƒ“áƒ˜",
          "desc": "",
          "price": 22
        },
        {
          "id": 26,
          "name": "áƒ¦áƒáƒ áƒ˜áƒ¡ áƒ›áƒ¬áƒ•áƒáƒ“áƒ˜",
          "desc": "",
          "price": 28
        },
        {
          "id": 27,
          "name": "áƒ¨áƒ”áƒ›áƒ¬áƒ•áƒáƒ áƒ˜ áƒ‘áƒáƒ¡áƒ¢áƒœáƒ”áƒ£áƒšáƒ˜",
          "desc": "",
          "price": 15
        },
        {
          "id": 28,
          "name": "áƒ¨áƒ”áƒ›áƒ¬áƒ•áƒáƒ áƒ˜ áƒ™áƒáƒšáƒ›áƒáƒ®áƒ˜",
          "desc": "",
          "price": 35
        },
        {
          "id": 29,
          "name": "áƒ¨áƒ”áƒ›áƒ¬áƒ•áƒáƒ áƒ˜ áƒ¦áƒáƒ áƒ˜áƒ¡ áƒœáƒ”áƒ™áƒœáƒ”áƒ‘áƒ˜",
          "desc": "",
          "price": 45
        },
        {
          "id": 30,
          "name": "áƒ¨áƒ¥áƒ›áƒ”áƒ áƒ£áƒšáƒ˜",
          "desc": "",
          "price": 26
        },
        {
          "id": 34,
          "name": "áƒ¥áƒáƒ—áƒ›áƒ˜áƒ¡ áƒ‘áƒáƒ˜áƒ¢áƒ¡áƒ”áƒ‘áƒ˜",
          "desc": "",
          "price": 18
        },
        {
          "id": 45,
          "name": "áƒ®áƒáƒ áƒªáƒ˜áƒ¡ áƒ‘áƒšáƒ˜áƒœáƒ”áƒ‘áƒ˜ (5áƒª)",
          "desc": "",
          "price": 18
        }
      ]
    },
    {
      "name": "áƒªáƒáƒ›áƒ”áƒ£áƒšáƒ˜",
      "items": [
        {
          "id": 5,
          "name": "áƒ˜áƒ›áƒ”áƒ áƒ£áƒšáƒ˜ áƒ®áƒáƒ­áƒáƒáƒ£áƒ áƒ˜",
          "desc": "",
          "price": 22
        },
        {
          "id": 9,
          "name": "áƒšáƒáƒ‘áƒ˜áƒáƒœáƒ˜",
          "desc": "",
          "price": 20
        },
        {
          "id": 10,
          "name": "áƒ›áƒ”áƒ’áƒ áƒ£áƒšáƒ˜ áƒ®áƒáƒ­áƒáƒáƒ£áƒ áƒ˜",
          "desc": "",
          "price": 25
        },
        {
          "id": 14,
          "name": "áƒáƒ˜áƒªáƒ áƒ›áƒáƒ áƒ’áƒáƒ áƒ˜áƒ¢áƒ",
          "desc": "",
          "price": 28
        },
        {
          "id": 15,
          "name": "áƒáƒ˜áƒªáƒ áƒáƒ”áƒáƒ”áƒ áƒáƒœáƒ˜",
          "desc": "",
          "price": 30
        },
        {
          "id": 16,
          "name": "áƒáƒ£áƒ áƒ˜ áƒ“áƒ áƒ­áƒ•áƒ˜áƒ¨áƒ¢áƒáƒ áƒ˜",
          "desc": "",
          "price": 12
        },
        {
          "id": 17,
          "name": "áƒáƒ£áƒ áƒ˜áƒ¡ áƒáƒ¡áƒáƒ áƒ¢áƒ˜",
          "desc": "",
          "price": 5
        },
        {
          "id": 31,
          "name": "áƒ›áƒ­áƒáƒ“áƒ˜",
          "desc": "",
          "price": 32
        },
        {
          "id": 35,
          "name": "áƒ®áƒ˜áƒœáƒ™áƒáƒšáƒ˜",
          "desc": "",
          "price": 15
        }
      ]
    },
    {
      "name": "áƒ’áƒáƒ áƒœáƒ˜áƒ áƒ˜",
      "items": [
        {
          "id": 6,
          "name": "áƒ™áƒáƒ áƒ¢áƒáƒ¤áƒ˜áƒšáƒ˜ áƒ¤áƒ áƒ˜ áƒ“áƒ áƒ™áƒ”áƒ©áƒ£áƒáƒ˜",
          "desc": "",
          "price": 15
        },
        {
          "id": 11,
          "name": "áƒ›áƒ”áƒ¥áƒ¡áƒ˜áƒ™áƒ£áƒ áƒ˜ áƒ™áƒáƒ áƒ¢áƒáƒ¤áƒ˜áƒšáƒ˜ áƒ¡áƒáƒ£áƒ¡áƒ˜áƒ—",
          "desc": "",
          "price": 15
        },
        {
          "id": 20,
          "name": "áƒ¢áƒ§áƒ”áƒ›áƒáƒšáƒ˜",
          "desc": "",
          "price": 3
        }
      ]
    },
    {
      "name": "áƒªáƒ˜áƒ•áƒ˜",
      "items": [
        {
          "id": 36,
          "name": "áƒ®áƒ˜áƒ–áƒ˜áƒšáƒáƒšáƒ áƒ™áƒáƒ áƒáƒ¥áƒ˜áƒ—",
          "desc": "",
          "price": 20
        },
        {
          "id": 37,
          "name": "áƒœáƒáƒ“áƒ£áƒ¦áƒ˜ áƒ¡áƒ£áƒšáƒ£áƒ’áƒ£áƒœáƒ˜áƒ¡ áƒ¤áƒ˜áƒ áƒ¤áƒ˜áƒ¢áƒ”áƒ‘áƒ¨áƒ˜ (5áƒª)",
          "desc": "",
          "price": 18
        },
        {
          "id": 38,
          "name": "áƒ§áƒ•áƒ”áƒšáƒ˜áƒ¡ áƒ“áƒáƒ¤áƒ - áƒ“áƒ˜áƒ“áƒ˜",
          "desc": "",
          "price": 25
        },
        {
          "id": 39,
          "name": "áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜ áƒ§áƒ•áƒ”áƒšáƒ˜áƒ¡ áƒ“áƒáƒ¤áƒ - áƒáƒáƒ¢áƒáƒ áƒ",
          "desc": "",
          "price": 17
        },
        {
          "id": 42,
          "name": "áƒ‘áƒáƒ“áƒ áƒ˜áƒ¯áƒáƒœáƒ˜ áƒœáƒ˜áƒ’áƒ•áƒ–áƒ˜áƒ—",
          "desc": "",
          "price": 15
        },
        {
          "id": 43,
          "name": "áƒ›áƒŸáƒáƒ•áƒ˜áƒ¡ áƒáƒ¡áƒáƒ áƒ¢áƒ˜",
          "desc": "",
          "price": 14
        },
        {
          "id": 44,
          "name": "áƒ–áƒ”áƒ—áƒ˜áƒ¡áƒ®áƒ˜áƒšáƒ˜",
          "desc": "",
          "price": 9
        }
      ]
    },
    {
      "name": "áƒ“áƒ”áƒ¡áƒ”áƒ áƒ¢áƒ˜",
      "items": [
        {
          "id": 40,
          "name": "áƒ®áƒ˜áƒšáƒ˜áƒ¡ áƒáƒ¡áƒáƒ áƒ¢áƒ˜",
          "desc": "",
          "price": 23
        },
        {
          "id": 41,
          "name": "áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜ áƒœáƒ£áƒ’áƒ‘áƒáƒ áƒ˜",
          "desc": "",
          "price": 26
        }
      ]
    },
    {
      "name": "áƒ¡áƒáƒ¡áƒ›áƒ”áƒšáƒ˜",
      "items": [
        {
          "id": 46,
          "name": "áƒ™áƒáƒ™áƒ áƒ™áƒáƒšáƒ",
          "desc": "",
          "price": 5
        },
        {
          "id": 47,
          "name": "áƒ™áƒáƒšáƒ áƒ–áƒ”áƒ áƒ",
          "desc": "",
          "price": 5
        },
        {
          "id": 48,
          "name": "áƒ¤áƒáƒœáƒ¢áƒ",
          "desc": "",
          "price": 5
        },
        {
          "id": 49,
          "name": "áƒ¡áƒáƒ áƒáƒ˜áƒ¢áƒ˜",
          "desc": "",
          "price": 5
        },
        {
          "id": 50,
          "name": "áƒšáƒ˜áƒ›áƒáƒœáƒáƒ—áƒ˜",
          "desc": "",
          "price": 4
        },
        {
          "id": 51,
          "name": "áƒœáƒáƒ¢áƒ£áƒ áƒáƒšáƒ£áƒ áƒ˜ áƒ¬áƒ•áƒ”áƒœáƒ˜ 1áƒš",
          "desc": "",
          "price": 20
        },
        {
          "id": 52,
          "name": "áƒ¡áƒáƒ®áƒšáƒ˜áƒ¡ áƒšáƒ˜áƒ›áƒáƒœáƒáƒ—áƒ˜ 1 áƒš",
          "desc": "",
          "price": 20
        },
        {
          "id": 53,
          "name": "áƒ¬áƒ§áƒáƒšáƒ˜",
          "desc": "",
          "price": 3
        },
        {
          "id": 54,
          "name": "áƒ›áƒ˜áƒœáƒ”áƒ áƒáƒšáƒ£áƒ áƒ˜ áƒ¬áƒ§áƒáƒšáƒ˜",
          "desc": "",
          "price": 4
        },
        {
          "id": 55,
          "name": "áƒáƒ£áƒœáƒ¨áƒ˜",
          "desc": "",
          "price": 200
        },
        {
          "id": 56,
          "name": "áƒáƒ áƒáƒ§áƒ˜ 1áƒš",
          "desc": "",
          "price": 80
        },
        {
          "id": 57,
          "name": "áƒ”áƒ•áƒ áƒáƒáƒ£áƒšáƒ˜ áƒ—áƒ”áƒ—áƒ áƒ˜ 1áƒš",
          "desc": "",
          "price": 30
        },
        {
          "id": 58,
          "name": "áƒ›áƒáƒ áƒáƒœáƒ˜ áƒ¡áƒáƒ¤áƒ”áƒ áƒáƒ•áƒ˜ 1áƒš",
          "desc": "",
          "price": 30
        },
        {
          "id": 59,
          "name": "áƒáƒ áƒáƒ§áƒ˜ áƒáƒ‘áƒ¡áƒáƒšáƒ£áƒ¢áƒ˜",
          "desc": "",
          "price": 120
        }
      ]
    }
  ]
};
// =============================================================================

var qty = {};

function gel(id) { return document.getElementById(id); }
function fmt(n)  { return Math.round(n).toString(); }
function pad(n)  { return n < 10 ? '0' + n : '' + n; }

function getNow() {
  var d = new Date();
  return {
    date: pad(d.getDate()) + '-' + pad(d.getMonth()+1) + '-' + String(d.getFullYear()).slice(-2),
    time: pad(d.getHours()) + ':' + pad(d.getMinutes())
  };
}

function isDesktop() {
  try { return window.matchMedia('(hover:hover) and (pointer:fine)').matches && window.innerWidth > 900; }
  catch(e) { return false; }
}

function isInAppBrowser() {
  var ua = navigator.userAgent || '';
  return /FBAN|FBAV|Instagram|Twitter|LinkedInApp|Snapchat|MicroMessenger|Line\/|WhatsApp/.test(ua);
}

var _state = { q: {}, n: '', g: '2' };
function saveState() {
  try {
    _state.q = qty; _state.n = gel('guest-name').value; _state.g = gel('guest-count').value;
    sessionStorage.setItem('td3', JSON.stringify(_state));
  } catch(e) {}
}
function loadState() {
  try { var s = JSON.parse(sessionStorage.getItem('td3')); if (s) _state = s; } catch(e) {}
  return _state;
}

// =============================================================================
// BUILD MENU â€” all layout via inline styles, immune to CSS/WebView issues
// =============================================================================
function buildMenu() {
  var saved = loadState();
  var sq = saved.q || {};
  var rn = gel('r-name'); if (rn) rn.textContent = MENU_DATA.restaurantName;
  document.title = MENU_DATA.restaurantName;
  var mn = gel('min-note'); if (mn) mn.textContent = 'áƒ›áƒ˜áƒœáƒ˜áƒ›áƒ£áƒ›áƒ˜: ' + MENU_DATA.minimumPerGuest + ' áƒšáƒáƒ áƒ˜ áƒ”áƒ áƒ— áƒ¡áƒ¢áƒ£áƒ›áƒáƒ áƒ–áƒ”';
  var wrap = gel('menu-wrap'); if (!wrap) return;
  wrap.innerHTML = '';

  var cats = MENU_DATA.categories;
  for (var ci = 0; ci < cats.length; ci++) {
    var cat = cats[ci];
    var sec = document.createElement('div');
    sec.style.marginBottom = '36px';
    var ct = document.createElement('div');
    ct.style.cssText = "font-family:'Noto Sans Georgian','Playfair Display',Georgia,serif;font-size:1.2rem;color:#6B4C35;padding-bottom:8px;border-bottom:2px solid #C8952A;margin-bottom:12px;margin-top:36px;";
    ct.textContent = cat.name;
    sec.appendChild(ct);

    for (var ii = 0; ii < cat.items.length; ii++) {
      var item = cat.items[ii];
      var rq = parseInt(sq[item.id]) || 0;
      qty[item.id] = rq;

      var card = document.createElement('div');
      card.id = 'c-' + item.id;
      card.style.cssText = 'display:table;table-layout:fixed;width:100%;box-sizing:border-box;background:' + (rq > 0 ? '#FFFCF4' : '#fff') + ';border:1px solid ' + (rq > 0 ? '#C8952A' : '#E2D9CC') + ';border-radius:10px;padding:13px 14px;margin-bottom:10px;';

      // Name + desc
      var c1 = document.createElement('div');
      c1.style.cssText = 'display:table-cell;vertical-align:middle;width:auto;padding-right:10px;overflow:hidden;';
      var nm = document.createElement('div');
      nm.style.cssText = 'font-weight:500;font-size:.95rem;color:#1A1410;';
      nm.textContent = item.name;
      c1.appendChild(nm);
      if (item.desc) {
        var ds = document.createElement('div');
        ds.style.cssText = 'font-size:.74rem;color:#8B7355;margin-top:2px;';
        ds.textContent = item.desc;
        c1.appendChild(ds);
      }

      // Price â€” fixed 48px right-aligned
      var c2 = document.createElement('div');
      c2.style.cssText = "display:table-cell;vertical-align:middle;white-space:nowrap;width:48px;min-width:48px;padding-right:14px;font-family:'Noto Sans Georgian','Playfair Display',Georgia,serif;font-size:.95rem;color:#6B4C35;text-align:right;";
      c2.textContent = fmt(item.price);

      // Qty controls â€” fixed 110px centred
      var c3 = document.createElement('div');
      c3.style.cssText = 'display:table-cell;vertical-align:middle;white-space:nowrap;width:110px;min-width:110px;padding-right:10px;text-align:center;';
      var btnStyle = 'width:30px;height:30px;border:1px solid #E2D9CC;background:#fff;border-radius:50%;font-size:1.1rem;cursor:pointer;color:#6B4C35;vertical-align:middle;line-height:1;padding:0;-webkit-tap-highlight-color:transparent;touch-action:manipulation;display:inline-block;';
      var inpStyle = 'width:34px;text-align:center;padding:4px 0;border:1px solid #E2D9CC;border-radius:6px;font-size:.88rem;font-family:inherit;background:#fff;vertical-align:middle;-webkit-appearance:none;margin:0 3px;';
      var bm = document.createElement('button');
      bm.type = 'button'; bm.textContent = '-'; bm.setAttribute('data-id', item.id); bm.setAttribute('data-d', '-1'); bm.style.cssText = btnStyle;
      var inp = document.createElement('input');
      inp.type = 'number'; inp.id = 'q-' + item.id; inp.value = rq; inp.min = '0'; inp.max = '99';
      inp.setAttribute('data-id', item.id); inp.style.cssText = inpStyle;
      var bp = document.createElement('button');
      bp.type = 'button'; bp.textContent = '+'; bp.setAttribute('data-id', item.id); bp.setAttribute('data-d', '1'); bp.style.cssText = btnStyle;
      c3.appendChild(bm); c3.appendChild(inp); c3.appendChild(bp);

      // Row total â€” fixed 54px right-aligned
      var c4 = document.createElement('div');
      c4.id = 't-' + item.id;
      c4.style.cssText = 'display:table-cell;vertical-align:middle;text-align:right;white-space:nowrap;width:54px;min-width:54px;font-weight:' + (rq > 0 ? '600' : '400') + ';color:' + (rq > 0 ? '#C8952A' : '#8B7355') + ';';
      c4.textContent = rq > 0 ? fmt(rq * item.price) : '-';

      card.appendChild(c1); card.appendChild(c2); card.appendChild(c3); card.appendChild(c4);
      sec.appendChild(card);
    }
    wrap.appendChild(sec);
  }

  if (saved.n) { var gn2 = gel('guest-name'); if (gn2) gn2.value = saved.n; }
  if (saved.g) { var gc2 = gel('guest-count'); if (gc2) gc2.value = saved.g; }

  wrap.addEventListener('click', function(e) {
    var el = e.target || e.srcElement;
    while (el && el !== wrap) { if (el.getAttribute && el.getAttribute('data-d')) break; el = el.parentNode; }
    if (el && el !== wrap) {
      var id = parseInt(el.getAttribute('data-id'));
      var nv = Math.max(0, (qty[id] || 0) + parseInt(el.getAttribute('data-d')));
      var i2 = gel('q-' + id); if (i2) i2.value = nv;
      applyQty(id, nv);
    }
  });
  wrap.addEventListener('change', function(e) { var el = e.target || e.srcElement; if (el && el.getAttribute('data-id')) applyQty(parseInt(el.getAttribute('data-id')), parseInt(el.value) || 0); });
  wrap.addEventListener('input',  function(e) { var el = e.target || e.srcElement; if (el && el.getAttribute('data-id')) applyQty(parseInt(el.getAttribute('data-id')), parseInt(el.value) || 0); });
  updateFooter();
}

function applyQty(id, v) {
  var q = Math.max(0, isNaN(v) ? 0 : v);
  qty[id] = q;
  var inp = gel('q-' + id); if (inp) inp.value = q;
  var price = 0, cats = MENU_DATA.categories;
  for (var i = 0; i < cats.length; i++) for (var j = 0; j < cats[i].items.length; j++) if (cats[i].items[j].id === id) { price = cats[i].items[j].price; break; }
  var tot = gel('t-' + id), card = gel('c-' + id);
  if (q > 0) { tot.textContent = fmt(q * price); tot.style.color = '#C8952A'; tot.style.fontWeight = '600'; card.style.background = '#FFFCF4'; card.style.border = '1px solid #C8952A'; }
  else        { tot.textContent = '-';            tot.style.color = '#8B7355'; tot.style.fontWeight = '400'; card.style.background = '#fff';    card.style.border = '1px solid #E2D9CC'; }
  saveState(); updateFooter();
}

function calcTotals() {
  var sub = 0, ct = 0, cats = MENU_DATA.categories;
  for (var i = 0; i < cats.length; i++) for (var j = 0; j < cats[i].items.length; j++) { var q = qty[cats[i].items[j].id] || 0; sub += q * cats[i].items[j].price; ct += q; }
  var svc = Math.floor(sub * 0.1);
  return { sub: sub, svc: svc, grand: sub + svc, ct: ct };
}

function updateFooter() {
  var t = calcTotals();
  var guests = parseInt(gel('guest-count').value) || 0;
  var min = guests * MENU_DATA.minimumPerGuest;
  var name = gel('guest-name').value.trim();
  gel('f-sub').textContent = fmt(t.sub); gel('f-svc').textContent = fmt(t.svc); gel('f-grand').textContent = fmt(t.grand);
  gel('f-ct').textContent = t.ct === 0 ? 'áƒ™áƒ”áƒ áƒ«áƒ˜ áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒáƒ áƒ©áƒ”áƒ£áƒšáƒ˜' : t.ct + ' áƒáƒ áƒ©áƒ”áƒ£áƒšáƒ˜ áƒ™áƒ”áƒ áƒ«áƒ”áƒ‘áƒ˜áƒ¡ áƒ“áƒ áƒ¡áƒáƒ¡áƒ›áƒ”áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ';
  var msg = gel('val-msg'), btn = gel('confirm-btn');
  if      (t.ct === 0)    { msg.textContent = 'áƒ“áƒáƒ˜áƒ¬áƒ§áƒ”áƒ— áƒ™áƒ”áƒ áƒ«áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒ áƒ©áƒ”áƒ•áƒ';                                                     msg.className = 'val-msg';      btn.disabled = true;  }
  else if (!name)          { msg.textContent = 'áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ”áƒ— áƒ¡áƒ¢áƒ£áƒ›áƒ áƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜';                                                 msg.className = 'val-msg warn'; btn.disabled = true;  }
  else if (guests === 0)   { msg.textContent = 'áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ”áƒ— áƒ¡áƒ¢áƒ£áƒ›áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ';                                          msg.className = 'val-msg warn'; btn.disabled = true;  }
  else if (t.sub < min)   { msg.textContent = 'áƒ“áƒáƒáƒ›áƒáƒ¢áƒ”áƒ— ' + fmt(min - t.sub) + ' áƒšáƒáƒ áƒ˜ (áƒ›áƒ˜áƒœ. ' + fmt(min) + ')';              msg.className = 'val-msg warn'; btn.disabled = true;  }
  else                    { msg.textContent = 'áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ áƒ¨áƒ”áƒ˜áƒ«áƒšáƒ”áƒ‘áƒ';                                               msg.className = 'val-msg ok';   btn.disabled = false; }
}

function buildRows() {
  var rows = '', cats = MENU_DATA.categories;
  for (var ci = 0; ci < cats.length; ci++) {
    var catRows = '', items = cats[ci].items;
    for (var ii = 0; ii < items.length; ii++) { var item = items[ii], q = qty[item.id] || 0; if (q > 0) catRows += '<tr><td>' + item.name + '</td><td class="r">' + q + '</td><td class="r">' + fmt(item.price) + '</td><td class="r">' + fmt(q * item.price) + '</td></tr>'; }
    if (catRows) rows += '<tr class="cat-row"><td colspan="4">' + cats[ci].name + '</td></tr>' + catRows;
  }
  return rows;
}

function buildOverlayHTML(guestName, guests, dt, t, rows) {
  return '<div class="rc-head"><h2>' + MENU_DATA.restaurantName + '</h2><p>áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ</p></div>' +
    '<div class="rc-meta"><div><div class="rc-gn">' + guestName + '</div><div>' + guests + ' áƒ¡áƒ¢áƒ£áƒ›áƒáƒ áƒ˜' + '</div></div><div class="rc-rt">' + dt.date + '<br>' + dt.time + '</div></div>' +
    '<table class="rc-tbl"><thead><tr><th>áƒ“áƒáƒ¡áƒáƒ®áƒ”áƒšáƒ”áƒ‘áƒ</th><th class="r">áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ</th><th class="r">áƒ¤áƒáƒ¡áƒ˜</th><th class="r">áƒ¯áƒáƒ›áƒ˜</th></tr></thead><tbody>' + rows + '</tbody></table>' +
    '<div class="rc-tots"><table class="rc-ti"><tr><td class="lb">áƒ¯áƒáƒ›áƒ˜</td><td class="vl">' + fmt(t.sub) + '</td></tr><tr class="svc-r"><td class="lb">áƒ›áƒáƒ›áƒ¡áƒáƒ®áƒ£áƒ áƒ”áƒ‘áƒ 10%</td><td class="vl">' + fmt(t.svc) + '</td></tr><tr class="gnd-r"><td class="lb">áƒ›áƒ—áƒšáƒ˜áƒáƒœáƒáƒ“</td><td class="vl">' + fmt(t.grand) + '</td></tr></table></div>' +
    '<div class="rc-foot">áƒ¤áƒáƒ¡áƒ”áƒ‘áƒ˜ áƒ›áƒáƒ˜áƒªáƒáƒ•áƒ¡ áƒ“áƒ¦áƒ’-áƒ¡ 18%<br>áƒ—áƒ”áƒáƒ áƒ˜áƒ áƒ“áƒáƒ˜áƒœáƒ˜áƒœáƒ’áƒ˜, áƒáƒ£áƒ¨áƒ™áƒ˜áƒœáƒ˜áƒ¡ áƒ¥. 23, áƒ—áƒ‘áƒ˜áƒšáƒ˜áƒ¡áƒ˜, áƒ¢áƒ”áƒš.: 595-88-88-23</div>';
}

function buildDesktopPage(guestName, guests, dt, t, rows) {
  var css = [
    '*{margin:0;padding:0;box-sizing:border-box;}',
    'body{font-family:\'Noto Sans Georgian\',Georgia,sans-serif;color:#1A1410;background:#FAF7F2;}',
    '.page{background:#fff;max-width:700px;margin:0 auto;}',
    /* Toolbar â€” always visible, not hidden on print */
    '.toolbar{background:#1A1410;padding:14px 20px;display:flex;align-items:center;justify-content:space-between;gap:10px;position:sticky;top:0;z-index:10;}',
    '.toolbar span{color:#aaa;font-size:.75rem;letter-spacing:.04em;}',
    '.back-btn{background:transparent;color:#aaa;border:1px solid #555;padding:10px 16px;border-radius:8px;font-family:\'Noto Sans Georgian\',Georgia,sans-serif;font-size:.9rem;cursor:pointer;}',
    '@media (hover:hover) and (pointer:fine) and (min-width:900px){.back-btn{display:none;}}',
    /* Big share button â€” easy to tap on mobile */
    '.tb-btn{background:#C8952A;color:#fff;border:none;padding:12px 24px;border-radius:8px;font-family:\'Noto Sans Georgian\',Georgia,sans-serif;font-size:1rem;font-weight:600;cursor:pointer;white-space:nowrap;}',
    '.receipt{padding:24px 20px;}',
    'h1{font-size:22px;letter-spacing:.03em;text-align:center;}',
    '.tag{font-size:8px;text-transform:uppercase;letter-spacing:.14em;color:#8B7355;margin-top:2px;margin-bottom:10px;text-align:center;}',
    'hr{border:none;border-top:2px solid #C8952A;margin-bottom:14px;}',
    '.meta{display:flex;justify-content:space-between;margin-bottom:14px;font-size:11px;color:#555;}',
    '.gn{font-size:14px;font-weight:bold;color:#1A1410;margin-bottom:2px;}',
    '.rt{text-align:right;line-height:1.7;}',
    'table{width:100%;border-collapse:collapse;margin-bottom:14px;}',
    'thead tr{background:#1A1410;}',
    'thead th{color:#E8B84B;padding:7px 8px;font-size:8px;text-transform:uppercase;letter-spacing:.06em;font-weight:600;text-align:left;}',
    'thead th.r{text-align:right;}',
    'tbody tr{border-bottom:1px solid #eee;}',
    'tbody td{padding:7px 8px;font-size:11px;}',
    '.cat-row td{background:#F5E6B8;color:#1A1410;font-weight:bold;font-size:10px;padding:7px 8px;}',
    '.r{text-align:right;}',
    '.tw{text-align:right;margin-bottom:18px;}',
    '.tt{display:inline-table;border-collapse:collapse;min-width:220px;}',
    '.tt td{padding:5px 8px;font-size:11px;}',
    '.tt .lb{color:#555;}',
    '.tt .vl{text-align:right;}',
    '.tt .sl td{border-top:1px solid #ddd;color:#555;}',
    '.tt .gl td{border-top:2px solid #C8952A;font-size:14px;font-weight:bold;padding-top:8px;}',
    '.foot{border-top:1px solid #E2D9CC;padding-top:9px;text-align:center;font-size:9px;color:#8B7355;line-height:1.9;margin-top:4px;}',
    '@media print{',
    '  *{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important;}',
    '  body{background:#fff;}',
    '  .toolbar{display:none;}',
    '  .page{max-width:100%;}',
    '  @page{margin:10mm;size:A4;}',
    '}'
  ].join('');

  var toolbar = '<div class="toolbar">'
    + '<button class="back-btn" onclick="history.back()">â† áƒ›áƒ”áƒœáƒ˜áƒ£áƒ–áƒ” áƒ“áƒáƒ‘áƒ áƒ£áƒœáƒ”áƒ‘áƒ</button>'
    + '<button class="tb-btn" onclick="window.print()">ğŸ“¤ áƒ¨áƒ”áƒœáƒáƒ®áƒ•áƒ / áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ</button>'
    + '</div>';

  var receipt = '<div class="receipt">'
    + '<h1>' + MENU_DATA.restaurantName + '</h1>'
    + '<div class="tag">áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ</div>'
    + '<hr>'
    + '<div class="meta"><div><div class="gn">' + guestName + '</div><div>' + guests + ' áƒ¡áƒ¢áƒ£áƒ›áƒáƒ áƒ˜</div></div>'
    + '<div class="rt">' + dt.date + '<br>' + dt.time + '</div></div>'
    + '<table><thead><tr><th>áƒ“áƒáƒ¡áƒáƒ®áƒ”áƒšáƒ”áƒ‘áƒ</th><th class="r">áƒ áƒáƒáƒ“.</th><th class="r">áƒ¤áƒáƒ¡áƒ˜</th><th class="r">áƒ¯áƒáƒ›áƒ˜</th></tr></thead>'
    + '<tbody>' + rows + '</tbody></table>'
    + '<div class="tw"><table class="tt">'
    + '<tr><td class="lb">áƒ¯áƒáƒ›áƒ˜</td><td class="vl">' + fmt(t.sub) + '</td></tr>'
    + '<tr class="sl"><td class="lb">áƒ›áƒáƒ›áƒ¡áƒáƒ®áƒ£áƒ áƒ”áƒ‘áƒ 10%</td><td class="vl">' + fmt(t.svc) + '</td></tr>'
    + '<tr class="gl"><td class="lb">áƒ›áƒ—áƒšáƒ˜áƒáƒœáƒáƒ“</td><td class="vl">' + fmt(t.grand) + '</td></tr>'
    + '</table></div>'
    + '<div class="foot">áƒ¤áƒáƒ¡áƒ”áƒ‘áƒ˜ áƒ›áƒáƒ˜áƒªáƒáƒ•áƒ¡ áƒ“áƒ¦áƒ’-áƒ¡ 18%<br>áƒ—áƒ”áƒáƒ áƒ˜áƒ áƒ“áƒáƒ˜áƒœáƒ˜áƒœáƒ’áƒ˜, áƒáƒ£áƒ¨áƒ™áƒ˜áƒœáƒ˜áƒ¡ áƒ¥. 23, áƒ—áƒ‘áƒ˜áƒšáƒ˜áƒ¡áƒ˜, áƒ¢áƒ”áƒš.: 595-88-88-23</div>'
    + '</div>';

  return '<!DOCTYPE html><html><head>'
    + '<meta charset="UTF-8">'
    + '<meta name="viewport" content="width=device-width,initial-scale=1">'
    + '<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Georgian:wght@400;600;700&display=swap" rel="stylesheet">'
    + '<title>' + MENU_DATA.restaurantName + ' - áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ</title>'
    + '<style>' + css + '</style>'
    + '</head><body>'
    + '<div class="page">' + toolbar + receipt + '</div>'
    + '</body></html>';
}

// =============================================================================
// SHARE RECEIPT
// 1. Build the receipt as an HTML blob file
// 2. On Android/iOS: use Web Share API to open native share sheet
//    â†’ user picks WhatsApp, Telegram, Email, Drive, etc.
// 3. Fallback: write receipt into current page, user taps print button
// =============================================================================
function generateAndSharePDF(guestName, guests, dt, t) {
  saveState();
  var rows = buildRows();
  var html = buildDesktopPage(guestName, guests, dt, t, rows);
  var fileName = 'Order-' + guestName.replace(/\s+/g,'-') + '-' + dt.date + '.html';

  // Try Web Share API (Android Chrome 75+, iOS Safari 15+)
  // This opens the native OS share sheet with WhatsApp, Telegram, Email etc.
  if (navigator.share && navigator.canShare) {
    var file = new File([html], fileName, { type: 'text/html' });
    if (navigator.canShare({ files: [file] })) {
      navigator.share({ files: [file], title: MENU_DATA.restaurantName + ' - áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ' })
        .catch(function(e) { if (e.name !== 'AbortError') showReceiptPage(html); });
      return;
    }
  }

  // Fallback: write receipt into current tab â€” user taps the print/share button
  showReceiptPage(html);
}

function showReceiptPage(html) {
  document.open();
  document.write(html);
  document.close();
}

function triggerDownload(blob, fileName) {
  var url = URL.createObjectURL(blob);
  var a = document.createElement('a');
  a.href = url; a.download = fileName; a.style.display = 'none';
  document.body.appendChild(a); a.click(); document.body.removeChild(a);
  setTimeout(function() { URL.revokeObjectURL(url); }, 5000);
}

// =============================================================================
// INIT â€” all DOM access here, after DOM is ready (fixes iOS local file crash)
// =============================================================================
function init() {
  // In-app browser banner (FB Messenger, WhatsApp, Instagram)
  if (isInAppBrowser()) {
    var banner = gel('open-banner');
    if (banner) {
      banner.style.display = 'block';
      var hdr = document.querySelector('header');
      if (hdr) hdr.style.top = banner.offsetHeight + 'px';
    }
    var link = gel('safari-link');
    if (link && window.location.href.indexOf('http') === 0) {
      link.href = window.location.href; link.target = '_blank';
    } else if (link) {
      link.textContent = 'Tap menu \u22EE or Share \u2192 Open in Browser';
      link.href = '#'; link.style.background = '#555';
    }
  }

  var msg = gel('val-msg');
  var gc = gel('guest-count');
  var gn = gel('guest-name');
  var cb = gel('confirm-btn');
  var os = gel('ov-send');
  var oc = gel('ov-close');
  var ov = gel('overlay');

  if (gc) gc.addEventListener('input', function() { saveState(); updateFooter(); });
  if (msg) msg.style.cursor = 'pointer';
  if (msg) msg.addEventListener('click', function() { var gn2 = gel('guest-name'); if (gn2) { gn2.focus(); gn2.scrollIntoView({ behavior: 'smooth', block: 'center' }); } });
  if (gn) gn.addEventListener('input', function() { saveState(); updateFooter(); });

  // Store current order data so the Send button can access it
  var _orderData = null;

  if (cb) cb.addEventListener('click', function() {
    var t         = calcTotals();
    var guestName = (gel('guest-name').value || '').trim() || 'Guest';
    var guests    = gel('guest-count').value;
    var dt        = getNow();
    saveState();
    var rows = buildRows();
    var html = buildDesktopPage(guestName, guests, dt, t, rows);

    if (isDesktop()) {
      // Desktop: open in new tab
      var win = window.open('', '_blank');
      if (win) { win.document.open(); win.document.write(html); win.document.close(); }
    } else {
      // Mobile: replace current page with receipt
      // The receipt has one big Share button directly wired to window.print()
      // which opens native iOS/Android share sheet on direct user tap
      document.open(); document.write(html); document.close();
    }
  });

  // ov-send kept for fallback but not shown in new flow
  if (os) os.addEventListener('click', function() {
    if (!_orderData) return;
    generateAndSharePDF(_orderData.guestName, _orderData.guests, _orderData.dt, _orderData.t);
  });

  if (oc) oc.addEventListener('click', function() { if (ov) ov.className = ''; });
  if (ov) ov.addEventListener('click', function(e) { if ((e.target || e.srcElement) === this) this.className = ''; });

  buildMenu();
}

if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', init);
} else {
  init();
}
</script>
</body>
</html>
